<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>About us</title>
</head>

<style>
    * {
    box-sizing: border-box;
    }

    html {
        scroll-behavior: smooth;

    }

    body {
        background-image: url("/images/hotel2.jpg");
        background-size: 100% 100vh; /* Use viewport height for better responsiveness */
        background-repeat: no-repeat;
        background-attachment: fixed;
        /*opacity: 80%;*/
    }

    .text {
        display: flex;
        justify-content: space-around;
        border-radius: 30px;
        gap: 1em;
        color: white;
    }

    .forms-container {
        display: flex;
        justify-content: center;
        gap: 2rem;
        width: 70%;
        margin: 0 auto;
    }

    .page-counter {
        margin: 0 auto;
    }

    .btn-primary {
        margin: 0.3em auto;
    }

    .pagination {
        margin: 0 auto 5em auto;
        gap: 1em;
    }

    .card-info p {
        color: white;
        background-color: #2e2d2c;
        margin-top: 1em;
        border-radius: 30px;
        padding: 1em;
    }

    .container {
        text-align: center;

    }

    #comments {
        color: white;
        border-radius: 20%;
        margin-bottom: 5em;
        width:30%;
        max-width: 100%;
        opacity: 85%;
        background-color: #2e2d2c;
    }

    .comment-title {
        display: flex;
        gap: 1em;
    }

    .author {
        font-style: italic;
    }

    .message-text {
        font-style: italic;
    }


    .allComments {
        display: flex;
        flex: 0 0 30%;
        flex-wrap: wrap;
        gap: 1em;
        justify-content: center;
        margin: 1em auto 1em auto;
        transition: opacity 0.3s ease-in-out;
        width: 100%;
    }

    #about {
        text-align: center;
    }

    .hidden {
        display: none;
    }

    .truncated {
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        max-width: 500px; /* Adjust as needed */
        display: inline-block; /* Ensures ellipsis are applied */
        vertical-align: top;
    }

    .form-content {
        max-width: 90%;
        margin: 0 auto;
    }

    /*.message-text {*/
    /*    position: relative;*/
    /*}*/

    .message-text p {
        word-break: break-word;
        overflow-wrap: break-word;
        white-space: pre-wrap; /* This ensures that whitespace is preserved but allows wrapping */
        max-height: 3em; /* Limit height to 3 lines (adjust as needed) */
        overflow: hidden;
    }

    .message-text.expanded p {
        white-space: pre-wrap; /* Allow wrapping when expanded */
        max-height: none; /* Remove height limit when expanded */
    }

    .showMoreBtn {
        display: none;
    }

    .truncated + .showMoreBtn {
        display: inline-block;
    }

    #commentContent {
        width: 100%;
    }

    .message {
        padding: 1.5em;
        color: white;
        text-align: center;
        width: 100%;
        max-width: 40ch;
        background-color: chocolate;
        margin: 0 auto;
        min-height: 200px;
        overflow: hidden;
        opacity: 80%;
        border-radius: 50px;
    }

    .allComments, #controls {
        transition: opacity 1.3s ease-in-out;
    }

</style>

<body>

<div th:insert="~{/fragments/nav-bar}"></div>


<section id="about" class="py-5">
    <h1 class="mb-4 text-white">About Our Hotel</h1>

    <div class="container">


        <div class="text">
            <div class="card-info">
                <p><b>Nestled in the heart of [City Name], [Hotel Name] is your oasis of luxury and comfort. Whether
                    you're
                    here
                    for business, pleasure, or a bit of both, our hotel offers a seamless blend of modern sophistication
                    and
                    timeless elegance. From our elegantly appointed rooms to our top-notch amenities, every detail has
                    been
                    thoughtfully designed to ensure your stay is nothing short of extraordinary.</b></p>
            </div>

            <div class="card-info">
                <p>At [Hotel Name], we pride ourselves on our exceptional service and warm hospitality. Our dedicated
                    staff
                    is
                    always at your service, ready to cater to your every need and ensure your stay is as comfortable as
                    possible. Start your day with a sumptuous breakfast at our gourmet restaurant, relax in our tranquil
                    spa, or
                    take a dip in our sparkling pool. For those looking to explore, our prime location puts you just
                    steps
                    away
                    from [Cityâ€™s Major Attractions].</p>
            </div>
        </div>

        <p class="text-white bg-dark rounded p-1"><em>Experience the perfect blend of style, comfort, and convenience at [Hotel Name].
            <br> Book your stay today and
            discover why we are the preferred choice for discerning travelers.</em></p>

    </div>

</section>


<div class="allComments">


    <div class="comments" th:each="comment, iterStat : ${comments.getContent()}" th:fragment="commentList">
        <div class="message" th:classappend="${iterStat.index >= 5} ? 'hidden'">

            <div class="comment-title">

                <h5 class="date" th:text="'Date: ' + ${comment.created.toLocalDate()}">Author</h5>

                <h5 class="author" th:text="'Author: ' + ${comment.author}">Author</h5>


            </div>
            <div class="message-text">
                <p th:attr="data-full-text=${comment.commentContent}"
                   th:text="'&quot;' + ${comment.commentContent} + '&quot;'"
                   th:classappend="${comment.commentContent.length() > 70} ? 'truncated' : ''"></p>
            </div>
            <button class="showWholeComment btn btn-secondary" th:if="${comment.commentContent.length() > 40}">Show
                More
            </button>

        </div>
    </div>

    <!--    <button id="allComments" th:if="${comments.getContent().size()} > 3">Show All Comments</button>-->
</div>

<!-- Page counter -->
<div th:unless="${comments.getTotalElements() < 4}" id="controls" class="page-counter text-white">

        <div class="col-md-12 text-center">
            <p>
                Page <span th:text="${comments.getNumber() + 1}"></span>
                of <span th:text="${comments.getTotalPages()}"></span>
            </p>
        </div>

</div>


<div th:unless="${comments.getTotalElements() < 4}" class="col-md-12 text-center">
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">

            <!-- Previous button -->
            <li class="page-item" th:classappend="${comments.number == 0} ? 'disabled' : ''">
                <a class="page-link rounded bg-dark text-white" th:href="@{${'/about'}(page=${comments.number - 1})}">Previous</a>
            </li>

            <!-- Next button -->
            <li class="page-item" th:classappend="${comments.number == comments.totalPages - 1} ? 'disabled' : ''">
                <a class="page-link pr-4 pl-4 rounded bg-dark text-white" th:href="@{${'/about'}(page=${comments.number + 1})}">Next</a>
            </li>

        </ul>
    </nav>
</div>

<div class="forms-container">

    <section id="comments" class="py-5">

        <div class="container">

            <form th:action="@{/about/addComment}" th:method="POST" th:object="${addCommentBindingModel}">

                <h2 class="mb-4">Leave a comment</h2>

                <div class="form-content">

                    <div class="form-name">

                        <label for="author">Your Name or Nickname</label>
                        <input type="text" class="form-control" id="author" th:field="*{author}"
                               th:errorclass="is-invalid"
                               min="3" max="30"
                               name="author" placeholder="Enter your name...">

                        <!--                        <label for="authorEmail">If you want you can leave email</label>-->
                        <!--                        <input type="text" class="form-control" id="authorEmail" th:field="*{author}"-->
                        <!--                               th:errorclass="is-invalid"-->
                        <!--                               min="3" max="30"-->
                        <!--                               name="author" placeholder="Enter your email...">-->

                        <small id="authorError" th:errors="*{author}"
                               class="invalid-feedback text-white  bg-danger rounded"></small>

                    </div>

                    <div class="form-text-content">

                        <label for="commentContent">Your comment</label>
                        <textarea class="form-control" id="commentContent" rows="4" th:field="*{commentContent}"
                                  th:errorclass="is-invalid"
                                  name="commentContent" placeholder="Your comment here."></textarea>

                        <small id="commentError" th:errors="*{commentContent}"
                               class="invalid-feedback text-white  bg-danger rounded"></small>
                    </div>


                </div>

                <div class="form-button">
                    <br>
                    <small th:if="${successCommentMessage}" th:text="${successCommentMessage}"
                           class="alert alert-success">
                        <!-- put some decoration after successful subscribe -->
                    </small>

                    <button type="submit" class="btn btn-primary">Leave a comment</button>

                </div>

            </form>

        </div>

    </section>

</div>
<div th:insert="~{/fragments/footer}"></div>

<script>

    document.addEventListener("DOMContentLoaded", function () {
        // Handle "Show More" for individual long comments
        document.querySelectorAll('.showWholeComment').forEach(button => {
            button.addEventListener('click', function () {
                const messageText = this.previousElementSibling;
                messageText.classList.remove('truncated');
                messageText.classList.add('expanded');
                this.style.display = 'none';
            });
        });
    });

    // Handle "Show More Comments" button
    //     const showMoreCommentsBtn = document.getElementById('allComments');
    //     if (showMoreCommentsBtn) {
    //         showMoreCommentsBtn.addEventListener('click', function () {
    //             document.querySelectorAll('.comments .hidden').forEach(comment => {
    //                 comment.classList.remove('hidden');
    //             });
    //             showMoreCommentsBtn.style.display = 'none';
    //         });
    //     }
    // });

</script>
<!--<script>$(document).on('click', '.page-item', function (e) {-->
<!--    e.preventDefault();-->
<!--    let url = $(this).attr('href');-->
<!--    $(this).prop('disabled', true); // Disable the button-->
<!--    $.get(url, function (data) {-->
<!--        $('#comment-container').html($(data).find('#comment-container').html());-->
<!--        $('#pagination-controls').html($(data).find('#pagination-controls').html());-->
<!--        $('.page-item').prop('disabled', false); // Re-enable the buttons after content is loaded-->
<!--    });-->
<!--});-->
<!--</script>-->

</body>
</html>