<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{fragments/head}"></th:block>
    <title>Contact Requests</title>

    <style>
        @media (max-width: 770px) {
            .table {
                display: flex;
                flex-direction: column;
                flex-wrap: wrap;
            }
             thead {
              display: none;
            }
        }
        body {
            background-image: url("/images/hotel2.jpg");
            background-size: cover; /* Use viewport height for better responsiveness */
            background-repeat: no-repeat;
            background-attachment: fixed;

        }

        table,
        h2,
        h4 {
            text-align: center;
        }

        .container {
            margin: 5em auto;
            opacity: 90%;
            font-size: 1.1rem;
        }

        #commentTable tr.selected {
            background-color: lightgray; /* Light grey background */
        }

        .buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1em;
        }

        .buttons a {
            align-self: center;
        }

        #commentTable {
            cursor: pointer;

            overflow-y: auto;
        }

        #commentTable th, #commentTable td,#commentTable tr {
            color: white;
            padding: 8px;
            border: 2px solid #ddd; /* Adds a line between rows */
        }

        #fullMessage {
            padding: 30px;
            background-color: #f9f9f9;
            max-width: 100%; /* Adjust based on your layout */
            max-height: 100%; /* Adjust based on your layout */
            overflow-y: auto; /* Adds a scrollbar if content is too long */
            word-wrap: break-word; /* Breaks long words */
            word-break: break-all; /* Breaks long words */
            white-space: pre-wrap; /* Preserves whitespace */
            text-align: center;
            border: 5px solid black; /* Adds a line between rows */
        }
    </style>
</head>
<body>
<th:block th:replace="~{fragments/nav-bar :: navbar}"></th:block>

<div class="container p-3 bg-dark rounded">

    <h2 class="text-white mt-2">New Contact Requests</h2>


        <table class="table" id="commentTable">
            <thead>
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Author</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Message</th>
            </tr>
            </thead>
            <tbody>
            <tr class="" th:each="request, iterStat : ${allNotCheckedContactRequest}" th:data-full-text="${request.message}"
                th:classappend="${iterStat.index == 0} ? 'selected'" th:data-content-id="${request.id}">

                <td th:text="${request.created.toLocalDate()}"></td>
                <td th:text="${request.created.toLocalTime().getHour()} + ':' + ${request.created.toLocalTime().getMinute()}"></td>
                <td th:text="${#strings.abbreviate(request.name, 15)}"></td>
                <td th:text="${#strings.abbreviate(request.email, 15)}"></td>
                <td th:text="${request.phoneNumber}"></td>
                <td th:text="${#strings.abbreviate(request.message, 20)}"></td>
            </tr>
            </tbody>
        </table>

        <h4 class="text-white">Message will be displayed here</h4>
        <div id="fullMessage"></div>
    </div>
    <br>
    <br>
    <div class="buttons">
        <a th:href="@{/moderator}" class="btn btn-info">Go back <br> to your panel</a>
        <form th:action="@{/moderator/requestChecked}" th:method="POST">
            <input type="hidden" id="selectedContentId" name="id"/>
            <button type="submit" class="btn btn-success">Done</button>
        </form>
        <form th:action="@{/moderator/allRequestsChecked}" th:method="POST">
            <input type="hidden" name="id"/>
            <button type="submit" class="btn btn-primary">All Done</button>
        </form>

</div>
<th:block th:replace="~{/fragments/footer}"></th:block>
<th:block th:replace="~{fragments/scripts}"></th:block>
<script src="/js/commentsAndContactRequestsScript.js"></script>
</body>
</html>