<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{fragments/head :: head}"></th:block>
    <title>Admin</title>

    <style>
        body {
            background-image: url("/images/hotel2.jpg");
            background-size: 100% 100vh; /* Use viewport height for better responsiveness */
            background-repeat: no-repeat;
            background-attachment: fixed;
            /*transition: background-image 1s ease;*/
            /*transition-delay: 3s;*/
        }

        body {
            margin: 0 auto;
        }

        select {
            overflow-y: auto;
        }

        .card {
            margin-bottom: 3em;
        }

        .cards {
            display: flex;
            margin: 3em auto;
            justify-content: center;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            flex: 0 1 30%;
            gap: 1em;
        }

        .userManagement {
            margin: 0 auto;
        }

        .smallContainers {
            display: flex;
            flex-direction: column;
            margin: 2em auto;
        }

        .white-placeholder::placeholder {
            color: white !important;
        }

        .black-placeholder::placeholder {
            color: black !important;
        }
    </style>
</head>
<body>

<th:block th:replace="~{fragments/nav-bar :: navbar}"></th:block>

<div class="cards">

    <div class="smallContainers">

        <div class="card">

            <div class="card-body bg-dark text-white">
                <h5 class="card-title">Rooms Overview</h5>
                <p class="card-text">Total Free Rooms: <span th:text="${freeRoomsCount}" id="free-rooms-count">XX</span>
                </p>
                <a th:href="@{/admin/freeRooms}" class="btn btn-primary">Check Free Rooms</a>
            </div>

        </div>


        <div class="card">

            <div class="card-body bg-dark text-white">
                <h5 class="card-title">Guests Overview</h5>
                <p class="card-text">Total Guests: <span th:text="${allGuestsCount}" id="totalGuestsCount">XX</span></p>
                <a th:href="@{/admin/allGuests}" class="btn btn-primary">See All Guests</a>
            </div>

        </div>

        <div class="card">

            <div class="card-body bg-dark text-white">
                <h5 class="card-title">Subscribers Overview</h5>
                <p class="card-text">Total Subscribers: <span th:text="${totalSubscribers}" id="totalSubscribersCount">XX</span>
                </p>
                <a th:href="@{/admin/allSubscribers}" class="btn btn-primary">See All Subscribers</a>
            </div>

        </div>

        <div class="card">

            <div class="card-body bg-dark text-white">
                <h5 class="card-title">Happy Guests Overview</h5>
                <p class="card-text">Total Happy Guests: <span th:text="${happyGuestsCount}" id="happyGuests">XX</span>
                </p>
                <a th:href="@{/admin/allHappyGuests}" class="btn btn-primary">See All Happy Guests</a>
            </div>

        </div>
        <div class="card">

            <div class="card-body bg-dark text-white">
                <h5 class="card-title">User Management</h5>
                <p class="card-text">Here you can control user privileges</p>
                <a th:href="@{/admin/allUsers}" class="btn btn-primary">See All Users</a>
            </div>

        </div>

    </div>

    <div class="smallContainers">

    </div>

    <div class="userManagement">

        <div class="card">

            <div class="card-body bg-dark text-white">

                <h5>User Management</h5>
                <br>
                <div class="form-group">

                    <h6>You can find user by email, or you can list all users</h6>

                    <label for="userSearch">Search User by Email:</label>
                    <input type="text" class="form-control" id="userSearch" placeholder="Enter user email">
                    <!--                    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>-->

                    <br>
                    <a href="#" class="btn btn-primary" id="userFindBtn">Find user by email</a>
                    <a href="#" class="btn btn-primary" id="getAllUsersBtn">List all users</a>


                    <br>
                    <br>

                    <div id="usersDropdown" hidden>

                        <label for="userSelect"> Select User:</label>
                        <select class="form-control bg-white" id="userSelect" size="5">
                            <option selected disabled class="text-white">Select User:</option>
                        </select>

                        <br>

                        <div class="buttons">

                            <form th:action="@{/admin/makeUserAdmin}" th:method="POST">
                                <!--                                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>-->
                                <button type="button" class="btn btn-success" id="makeAdmin">Make Admin</button>
                            </form>

                            <form th:action="@{/admin/makeUserModerator}" th:method="POST">
                                <!--                                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>-->
                                <button type="button" class="btn btn-warning" id="makeModerator">Make Moderator</button>
                            </form>

                            <form th:action="@{/admin/takeRights}" th:method="POST">
                                <button type="button" class="btn btn-danger" id="makeUser">Make User</button>
                            </form>

                            <form th:action="@{/admin/banUser}" th:method="POST">
                                <button type="button" class="btn btn-danger" id="banUser">BAN User</button>
                            </form>
                            <a th:href="@{/admin}" class="btn btn-success" id="clearBtn">Clear</a>

                        </div>

                    </div>

                </div>

                <div id="result"></div>

                <br><br>

                <h2 class="card-text">Total Profit: <span th:text="${totalProfit} + ' $'" id="total-profit">$XXX</span>
                </h2>

            </div>
        </div>
    </div>
</div>
<th:block th:replace="~{/fragments/footer :: footer}"></th:block>
<th:block th:replace="~{fragments/scripts :: scripts}"></th:block>
<script src="/js/usersFetch.js"></script>
</body>
</html>